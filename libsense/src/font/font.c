#include <unistd.h>
#include <stdio.h>
#include <stdint.h>
#include <string.h>
#include "framebuffer.h"

uint16_t font[10][3][8]={
    {{0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF},
        {0xFFFF,0,0,0,0,0,0,0xFFFF},
        {0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF}},
    //1
    {{0,0,0,0,0,0,0,0},{0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF},{0,0,0,0,0,0,0,0}},
    //2
    {{0xFFFF,0,0,0,0xFFFF,0xFFFF,0xFFFF,0xFFFF},
        {0xFFFF,0,0,0,0xFFFF,0,0,0xFFFF},
        {0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0,0,0xFFFF}},
    //3
    {{0xFFFF,0,0,0xFFFF,0,0,0,0xFFFF},
        {0xFFFF,0,0,0xFFFF,0,0,0,0xFFFF},
        {0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF}},
    //4
    {{0xFFFF,0xFFFF,0xFFFF,0xFFFF,0,0,0,0},
        {0,0,0,0xFFFF,0,0,0,0},
        {0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF}},
    //5
    {{0xFFFF,0xFFFF,0xFFFF,0xFFFF,0,0,0,0xFFFF},
        {0xFFFF,0,0,0xFFFF,0,0,0,0xFFFF},
        {0xFFFF,0,0,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF}},
    //6
    {{0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF},
        {0xFFFF,0,0,0,0xFFFF,0,0,0xFFFF},
        {0xFFFF,0,0,0,0xFFFF,0xFFFF,0xFFFF,0xFFFF}},
 //7
    {{0xFFFF,0,0,0,0,0,0,0},
        {0xFFFF,0,0,0,0,0,0,0},
        {0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF}},
    //8
    {{0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF},
        {0xFFFF,0,0,0xFFFF,0,0,0,0xFFFF},
        {0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF}},
    //9
    {{0xFFFF,0xFFFF,0xFFFF,0xFFFF,0,0,0,0xFFFF},
        {0xFFFF,0,0,0xFFFF,0,0,0,0xFFFF},
        {0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF,0xFFFF}},
};

/*setFramebufferDigit
	screen: the bitmap to draw on
	digit: the single digit 0-9 to draw
	pos; the position in the matrix (0=left,1=right) to draw
	color: the color to draw the digit with
	draws a digit on the bitmap*/
void setFramebufferDigit(sense_fb_bitmap_t* screen,int digit,int pos,uint16_t color){
    int i,j,startRow,index;
    startRow=pos==0?0:5;
    for (i=0;i<8;i++){
        for (j=startRow,index=2;j<startRow+3;j++,index--){
            screen->pixel[i][j]=color&font[digit][j-startRow][i];
        }
    }
}
/*setFramebufferNumber
	screen: the bitmap to draw on
	number: the number to draw (only draws 2 least significant digits)
	color: the color to draw with
	draws two digits on the bitmap representing the 2 least significant digits of the number*/
void setFramebufferNumber(sense_fb_bitmap_t* screen,int number,uint16_t color){
    int small=number%100;
    setFramebufferDigit(screen,small/10,0,color);
    setFramebufferDigit(screen,small%10,1,color);
}
